[2025-04-20T06:34:20.568+0000] {taskinstance.py:1979} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: etl_stg_to_dwh_to_mart.task_etl_to_dwh manual__2025-04-20T06:34:17.915257+00:00 [queued]>
[2025-04-20T06:34:20.584+0000] {taskinstance.py:1979} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: etl_stg_to_dwh_to_mart.task_etl_to_dwh manual__2025-04-20T06:34:17.915257+00:00 [queued]>
[2025-04-20T06:34:20.584+0000] {taskinstance.py:2193} INFO - Starting attempt 1 of 1
[2025-04-20T06:34:20.610+0000] {taskinstance.py:2217} INFO - Executing <Task(PythonOperator): task_etl_to_dwh> on 2025-04-20 06:34:17.915257+00:00
[2025-04-20T06:34:20.620+0000] {standard_task_runner.py:60} INFO - Started process 224 to run task
[2025-04-20T06:34:20.625+0000] {standard_task_runner.py:87} INFO - Running: ['***', 'tasks', 'run', 'etl_stg_to_dwh_to_mart', 'task_etl_to_dwh', 'manual__2025-04-20T06:34:17.915257+00:00', '--job-id', '5', '--raw', '--subdir', 'DAGS_FOLDER/main_etl.py', '--cfg-path', '/tmp/tmpp7mj2mvj']
[2025-04-20T06:34:20.628+0000] {standard_task_runner.py:88} INFO - Job 5: Subtask task_etl_to_dwh
[2025-04-20T06:34:20.698+0000] {task_command.py:423} INFO - Running <TaskInstance: etl_stg_to_dwh_to_mart.task_etl_to_dwh manual__2025-04-20T06:34:17.915257+00:00 [running]> on host d53bd6ff311d
[2025-04-20T06:34:20.841+0000] {taskinstance.py:2513} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='***' AIRFLOW_CTX_DAG_ID='etl_stg_to_dwh_to_mart' AIRFLOW_CTX_TASK_ID='task_etl_to_dwh' AIRFLOW_CTX_EXECUTION_DATE='2025-04-20T06:34:17.915257+00:00' AIRFLOW_CTX_TRY_NUMBER='1' AIRFLOW_CTX_DAG_RUN_ID='manual__2025-04-20T06:34:17.915257+00:00'
[2025-04-20T06:34:20.865+0000] {etl_to_dwh.py:54} INFO - Extract data Darwin703_Cruickshank494_4c9a07e5-1e1c-00a5-2841-2b1e0fce61e3.json...
[2025-04-20T06:34:21.088+0000] {etl_to_dwh.py:54} INFO - Extract data Leonor133_Silvia880_Colunga237_b0f6cc39-6dfd-4ac2-84c7-e7478723d563.json...
[2025-04-20T06:34:21.901+0000] {etl_to_dwh.py:54} INFO - Extract data Dudley365_Blick895_4f159375-4ee4-36ab-b464-6d38f6ff2dae.json...
[2025-04-20T06:34:22.098+0000] {etl_to_dwh.py:54} INFO - Extract data Lon587_Kuhic920_6c602779-9775-f512-2724-fa4e0d0788f5.json...
[2025-04-20T06:34:22.183+0000] {etl_to_dwh.py:54} INFO - Extract data Faustino767_Robel940_be3fe2c4-52da-02bb-e656-00e303e48a42.json...
[2025-04-20T06:34:22.213+0000] {etl_to_dwh.py:54} INFO - Extract data Carolina179_Otero621_5a3a689b-77d6-6c1a-7a86-a9c1b9b6847c.json...
[2025-04-20T06:34:22.402+0000] {etl_to_dwh.py:54} INFO - Extract data Britteny287_Brigida296_Carter549_9e9b5929-6880-fd20-f386-026109e24028.json...
[2025-04-20T06:34:22.519+0000] {etl_to_dwh.py:54} INFO - Extract data Alena861_Danna372_Gusikowski974_bd2a8021-2868-6dd2-c17f-bfd7c36fe247.json...
[2025-04-20T06:34:22.568+0000] {etl_to_dwh.py:54} INFO - Extract data Leticia253_María_Luisa888_Torres807_1c6c9d07-b38f-8fe5-fac9-0edd06a64f85.json...
[2025-04-20T06:34:22.808+0000] {etl_to_dwh.py:54} INFO - Extract data Antonia30_Schuster709_00732e11-5e4d-37b7-01f8-929a25536862.json...
[2025-04-20T06:34:22.840+0000] {etl_to_dwh.py:54} INFO - Extract data Pei116_Anderson154_21d26e56-f4e6-779d-e0d1-bdd371d8e4aa.json...
[2025-04-20T06:34:22.868+0000] {etl_to_dwh.py:54} INFO - Extract data Maris768_Lindgren255_898a6256-7ffb-dbe2-e24d-12fda2fedcfd.json...
[2025-04-20T06:34:24.028+0000] {etl_to_dwh.py:54} INFO - Extract data Aubrey96_Schmidt332_d27273f0-f62d-7d7f-746d-4565f35cf176.json...
[2025-04-20T06:34:24.134+0000] {etl_to_dwh.py:54} INFO - Extract data Adrianne466_Jonnie215_Glover433_99d3b9b2-46c1-ef9e-da70-81ac3d365f52.json...
[2025-04-20T06:34:24.156+0000] {etl_to_dwh.py:54} INFO - Extract data Delilah659_Sanford861_4f7a6432-3814-be2f-eb8a-1db4fe90e12d.json...
[2025-04-20T06:34:24.176+0000] {etl_to_dwh.py:54} INFO - Extract data Leigh689_White193_8635f76c-d1ee-89fe-9051-b90c16afd70c.json...
[2025-04-20T06:34:24.197+0000] {etl_to_dwh.py:54} INFO - Extract data Domenica436_Rau926_3648fb36-1cd1-3641-0b1c-1f00d1e7e7de.json...
[2025-04-20T06:34:24.223+0000] {etl_to_dwh.py:54} INFO - Extract data Diamond340_Keebler762_d6cc7569-5f31-9648-ec6a-e1162b32b183.json...
[2025-04-20T06:34:24.384+0000] {etl_to_dwh.py:54} INFO - Extract data Jimmie93_Doyle959_e335de09-0994-4111-3c15-6edcc17ae4bc.json...
[2025-04-20T06:34:24.424+0000] {etl_to_dwh.py:54} INFO - Extract data Maryjane289_Murazik203_ba459391-501f-22f5-3446-7defd52e5fab.json...
[2025-04-20T06:34:24.477+0000] {etl_to_dwh.py:54} INFO - Extract data Arnulfo253_Jaskolski867_50ca7edb-0dee-35e6-5d8f-66fbcb0b37c1.json...
[2025-04-20T06:34:24.540+0000] {etl_to_dwh.py:54} INFO - Extract data Laurie826_Tisa11_Bechtelar572_17e0bdef-4558-cc1d-2d44-90868cad827b.json...
[2025-04-20T06:34:24.763+0000] {etl_to_dwh.py:54} INFO - Extract data Aracelis412_Greenholt190_bd277bc3-11ad-a0bd-7057-4ec1b705610f.json...
[2025-04-20T06:34:24.801+0000] {etl_to_dwh.py:54} INFO - Extract data Alonzo487_Friesen796_32d7e67e-d2f7-8e45-a332-a763e004976b.json...
[2025-04-20T06:34:24.835+0000] {etl_to_dwh.py:54} INFO - Extract data Dahlia209_Ferry570_4804956b-3c8f-baa7-9a42-87518e486055.json...
[2025-04-20T06:34:24.864+0000] {etl_to_dwh.py:54} INFO - Extract data Princess223_Bobbi508_Schmeler639_33828cb4-a2f6-3a66-fe02-c990fa88af61.json...
[2025-04-20T06:34:24.897+0000] {etl_to_dwh.py:54} INFO - Extract data Tyree261_Champlin946_3d46defd-463f-a34b-4551-f9bbe96575bd.json...
[2025-04-20T06:34:25.092+0000] {etl_to_dwh.py:54} INFO - Extract data Blanca837_Reinger292_f339a5f7-0b09-3072-2b01-7c8e8ca2c1fc.json...
[2025-04-20T06:34:25.134+0000] {etl_to_dwh.py:54} INFO - Extract data Hattie299_Reatha769_Nader710_5e0a6984-38d7-c604-f55f-f1de5e933768.json...
[2025-04-20T06:34:25.163+0000] {etl_to_dwh.py:54} INFO - Extract data Kieth891_McKenzie376_081abe99-9641-1098-8903-61de9e66d9fa.json...
[2025-04-20T06:34:25.213+0000] {etl_to_dwh.py:54} INFO - Extract data Bernetta267_Rutherford999_81df73ed-e648-6a5d-22af-7f24d5fdb4cb.json...
[2025-04-20T06:34:25.236+0000] {etl_to_dwh.py:54} INFO - Extract data Dwight645_Hilll811_45b89342-dc05-8e57-8eee-9ed68ec42378.json...
[2025-04-20T06:34:25.298+0000] {etl_to_dwh.py:54} INFO - Extract data Truman805_Hermiston71_c1ce8dfc-3c0d-de97-ce0e-5dc0460da340.json...
[2025-04-20T06:34:25.494+0000] {etl_to_dwh.py:54} INFO - Extract data Berta524_Ester635_Alemán808_bf40c2b4-4f0d-10cf-a2bb-cbb235e4e437.json...
[2025-04-20T06:34:25.516+0000] {etl_to_dwh.py:54} INFO - Extract data Chana895_Schinner682_36ecae05-0060-b555-716f-303a8c34e914.json...
[2025-04-20T06:34:25.549+0000] {etl_to_dwh.py:54} INFO - Extract data Elsa29_Chapa957_f20c093a-ec77-3358-b0a5-3c298f82ea1f.json...
[2025-04-20T06:34:26.554+0000] {etl_to_dwh.py:54} INFO - Extract data Elna874_Dian810_Prohaska837_d1622e8b-d26b-ec81-ffcb-ec4bf2af385b.json...
[2025-04-20T06:34:26.655+0000] {etl_to_dwh.py:54} INFO - Extract data Willian804_Keeling57_c1acd7ba-dacf-36d2-6010-db8934400000.json...
[2025-04-20T06:34:26.694+0000] {etl_to_dwh.py:54} INFO - Extract data Aleen595_Alanna27_Rogahn59_5358446e-e631-c640-5880-c6cf99dc8bed.json...
[2025-04-20T06:34:26.850+0000] {etl_to_dwh.py:54} INFO - Extract data Hunter736_Gerlach374_7179458e-d6e3-c723-2530-d4acfe1c2668.json...
[2025-04-20T06:34:26.868+0000] {etl_to_dwh.py:54} INFO - Extract data Trinidad33_King743_18d9f8cb-b3b2-5e9f-4c62-5a82a90c0141.json...
[2025-04-20T06:34:26.886+0000] {etl_to_dwh.py:54} INFO - Extract data Gilbert263_Marvin195_8656f713-282f-e5f6-cc7e-346a573ef3b5.json...
[2025-04-20T06:34:26.917+0000] {etl_to_dwh.py:54} INFO - Extract data Dolly486_Franecki195_da7b1f55-c782-544f-ba8c-fe69d519dc85.json...
[2025-04-20T06:34:26.948+0000] {etl_to_dwh.py:54} INFO - Extract data Signe792_Salley758_Waters156_778f10bc-09e5-8e86-64e8-bffa36d47246.json...
[2025-04-20T06:34:27.304+0000] {etl_to_dwh.py:54} INFO - Extract data Grady603_Swaniawski813_cb1b46a1-9cb5-1187-ccc5-9fb7b98aa957.json...
[2025-04-20T06:34:27.591+0000] {etl_to_dwh.py:54} INFO - Extract data Homero668_Vigil207_fb164202-4e38-04a0-470a-b7229db13c04.json...
[2025-04-20T06:34:27.630+0000] {etl_to_dwh.py:54} INFO - Extract data Clair921_O'Reilly797_8a25981a-eb31-cb7c-047d-8249f6111a3e.json...
[2025-04-20T06:34:27.662+0000] {etl_to_dwh.py:54} INFO - Extract data Ulysses632_Schiller186_5032b4e1-c68e-b135-30ac-ad7e386b619b.json...
[2025-04-20T06:34:27.682+0000] {etl_to_dwh.py:54} INFO - Extract data Yun266_Ernser583_37713015-cfb5-bf1a-70eb-970101f32341.json...
[2025-04-20T06:34:27.729+0000] {etl_to_dwh.py:54} INFO - Extract data Ramiro608_Moreno82_bcd4d6cd-0c79-a19e-5b9e-64816e3fd72d.json...
[2025-04-20T06:34:27.785+0000] {etl_to_dwh.py:54} INFO - Extract data Teresa94_Pichardo350_74ad71cb-f64d-efce-02c9-ae3bc917c4a2.json...
[2025-04-20T06:34:28.038+0000] {etl_to_dwh.py:54} INFO - Extract data Tambra47_Balistreri607_916b1ac8-56c8-ec1b-3b9a-721336a74912.json...
[2025-04-20T06:34:28.070+0000] {etl_to_dwh.py:54} INFO - Extract data Harley673_Goldner995_699d2e19-7af4-de30-b430-ae854f5f690d.json...
[2025-04-20T06:34:28.098+0000] {etl_to_dwh.py:54} INFO - Extract data Moses679_Friesen796_98cbb02b-c16a-60e4-1ff0-37c0e45e0e9f.json...
[2025-04-20T06:34:28.293+0000] {etl_to_dwh.py:54} INFO - Extract data Jolyn4_Kattie846_Ortiz186_d5635f98-2461-70a1-5916-f854efa27fc0.json...
[2025-04-20T06:34:28.348+0000] {etl_to_dwh.py:54} INFO - Extract data Homero668_Quiñones183_5c779b5a-b6f0-2954-0c1c-9855c010d4d0.json...
[2025-04-20T06:34:28.368+0000] {etl_to_dwh.py:54} INFO - Extract data Arthur650_Roberts511_ec1a6cad-8825-7b5c-4e14-257c696d5f11.json...
[2025-04-20T06:34:28.394+0000] {etl_to_dwh.py:54} INFO - Extract data Nichol11_Stiedemann542_d3526c15-a6eb-ec69-d2ce-7f4dfac7fc5e.json...
[2025-04-20T06:34:28.410+0000] {etl_to_dwh.py:54} INFO - Extract data Tomás404_Benavides239_0689b59f-0721-5384-9294-def3c13db427.json...
[2025-04-20T06:34:28.426+0000] {etl_to_dwh.py:54} INFO - Extract data Robin66_Gleichner915_0fef2411-21f0-a269-82fb-c42b55471405.json...
[2025-04-20T06:34:28.441+0000] {etl_to_dwh.py:54} INFO - Extract data practitionerInformation1730906375349.json...
[2025-04-20T06:34:28.602+0000] {etl_to_dwh.py:54} INFO - Extract data Erasmo545_Connelly992_3e96ffd1-e286-f5ac-1606-539e37c7c46a.json...
[2025-04-20T06:34:28.649+0000] {etl_to_dwh.py:54} INFO - Extract data Anita473_Berta524_Sánchez310_d426334c-a982-3a31-7e0f-ca3c7fe01310.json...
[2025-04-20T06:34:28.691+0000] {etl_to_dwh.py:54} INFO - Extract data Margarette462_Britt177_West559_cca2c7f0-a2aa-94e5-ccea-cb78a7d38652.json...
[2025-04-20T06:34:28.709+0000] {etl_to_dwh.py:54} INFO - Extract data Sunday568_Lavonne167_Mitchell808_f07e12ed-dff4-6161-3d23-8f043c4e316d.json...
[2025-04-20T06:34:28.897+0000] {etl_to_dwh.py:54} INFO - Extract data Nathanael908_Wisozk929_f07fac6b-0a84-7874-f0d2-e1a1e1cffa09.json...
[2025-04-20T06:34:28.916+0000] {etl_to_dwh.py:54} INFO - Extract data Dominick530_Schiller186_116916b1-0b2b-e099-1b72-e8935f3bea0f.json...
[2025-04-20T06:34:28.934+0000] {etl_to_dwh.py:54} INFO - Extract data Dan465_Brakus656_b05fba34-1719-c0de-ac25-16e65de3d26a.json...
[2025-04-20T06:34:28.969+0000] {etl_to_dwh.py:54} INFO - Extract data Herbert830_Klocko335_8935bc21-92f0-a4ad-d8b4-bcdd5b92204a.json...
[2025-04-20T06:34:28.978+0000] {etl_to_dwh.py:54} INFO - Extract data Lael572_Schuppe920_3c7e37b0-c610-bc9a-d75a-f782e5dc7598.json...
[2025-04-20T06:34:28.987+0000] {etl_to_dwh.py:54} INFO - Extract data Wade235_Emmerich580_13cc1678-474c-7932-a719-c64f3a7adc9f.json...
[2025-04-20T06:34:29.157+0000] {etl_to_dwh.py:54} INFO - Extract data Yolanda648_Baca589_355f70c7-b1f4-b1db-8843-56b8b193a30c.json...
[2025-04-20T06:34:29.175+0000] {etl_to_dwh.py:54} INFO - Extract data Fabian647_Hayes766_de480ca4-19a6-f2e0-7922-1c51e7c8dcb8.json...
[2025-04-20T06:34:29.204+0000] {etl_to_dwh.py:54} INFO - Extract data Marisha663_Carter549_0bc53e6a-8820-ded4-57c5-7ccc6355354c.json...
[2025-04-20T06:34:29.226+0000] {etl_to_dwh.py:54} INFO - Extract data Stanton715_Kassulke119_780fe740-20fb-07ee-1fbd-3fafa9f5df91.json...
[2025-04-20T06:34:29.247+0000] {etl_to_dwh.py:54} INFO - Extract data Vivien121_Brakus656_5279920f-e303-9dca-844d-82ed5485f5da.json...
[2025-04-20T06:34:29.279+0000] {etl_to_dwh.py:54} INFO - Extract data Aleisha941_Treutel973_2d799deb-df07-0c4a-8692-42cce7595251.json...
[2025-04-20T06:34:29.301+0000] {etl_to_dwh.py:54} INFO - Extract data Marylee823_Trantow673_97df0b48-a67b-9b95-31c0-99bd722fd28e.json...
[2025-04-20T06:34:29.312+0000] {etl_to_dwh.py:54} INFO - Extract data Todd315_Abernathy524_a0b3ad14-4bd2-3abd-b02e-9116247d9fea.json...
[2025-04-20T06:34:29.325+0000] {etl_to_dwh.py:54} INFO - Extract data Bennie663_Ebert178_34a4dcc4-35fb-6ad5-ab98-be285c586a4f.json...
[2025-04-20T06:34:29.492+0000] {etl_to_dwh.py:54} INFO - Extract data Kimbery217_Schuppe920_2ce5c76d-8d65-1347-33c5-7d0cbf3f1b2b.json...
[2025-04-20T06:34:29.513+0000] {etl_to_dwh.py:54} INFO - Extract data Christopher407_Brakus656_9933f4bd-106c-b41d-467a-94ec42baeb81.json...
[2025-04-20T06:34:29.573+0000] {etl_to_dwh.py:54} INFO - Extract data Carlyn477_Florencia449_Williamson769_37c177ea-4398-fb7a-29fa-70eb3d673876.json...
[2025-04-20T06:34:29.620+0000] {etl_to_dwh.py:54} INFO - Extract data Nicki254_Jacobi462_c055bc9e-ce1a-b116-287a-be9162e35a2f.json...
[2025-04-20T06:34:29.648+0000] {etl_to_dwh.py:54} INFO - Extract data Lauralee67_Taren286_Sauer652_e73d2c53-6e7e-13b9-d296-460e42e6014a.json...
[2025-04-20T06:34:29.664+0000] {etl_to_dwh.py:54} INFO - Extract data hospitalInformation1730906375349.json...
[2025-04-20T06:34:30.758+0000] {etl_to_dwh.py:54} INFO - Extract data German382_Ebert178_bad5a231-3709-952a-cf44-f8d6a52cc214.json...
[2025-04-20T06:34:30.883+0000] {etl_to_dwh.py:54} INFO - Extract data Aurea194_Weissnat378_12696753-a126-88f4-da66-a87c70d2cad7.json...
[2025-04-20T06:34:30.916+0000] {etl_to_dwh.py:54} INFO - Extract data Tamara8_Schinner682_c3deeb5b-66ef-b1bf-0202-0e5ce485d30f.json...
[2025-04-20T06:34:31.094+0000] {etl_to_dwh.py:54} INFO - Extract data Ettie537_Farrell962_d8638449-e632-1ac7-6695-eb60c8773813.json...
[2025-04-20T06:34:31.126+0000] {etl_to_dwh.py:54} INFO - Extract data Carson894_Littel644_dc323bce-e583-d903-303e-9c865bc87e67.json...
[2025-04-20T06:34:31.162+0000] {etl_to_dwh.py:54} INFO - Extract data Sylvia544_Margherita470_Langworth352_488e5395-0a2a-f2da-0389-e0e8062b009d.json...
[2025-04-20T06:34:31.201+0000] {etl_to_dwh.py:54} INFO - Extract data Hershel911_Grant908_60fc807a-de74-7722-b431-a63362670472.json...
[2025-04-20T06:34:31.251+0000] {etl_to_dwh.py:54} INFO - Extract data Elvera717_Koepp521_8d2a62f2-d630-6288-93ee-0fea3f859560.json...
[2025-04-20T06:34:32.112+0000] {etl_to_dwh.py:54} INFO - Extract data Boyd728_Bosco882_f3884e8a-8b36-1e93-66dd-e910dfab2ef5.json...
[2025-04-20T06:34:32.196+0000] {etl_to_dwh.py:54} INFO - Extract data Khadijah960_Maryalice613_Veum823_9e24368b-f85b-f38f-ae0b-db191e224335.json...
[2025-04-20T06:34:32.850+0000] {etl_to_dwh.py:54} INFO - Extract data Zenia843_Genesis248_Weimann465_655baba7-47ed-22ac-2093-1196ebb44928.json...
[2025-04-20T06:34:32.920+0000] {etl_to_dwh.py:54} INFO - Extract data Lorenzo669_Hartmann983_3ec070e8-7f78-6a8b-12d7-9ee9808012e0.json...
[2025-04-20T06:34:32.942+0000] {etl_to_dwh.py:54} INFO - Extract data Caryl47_Kassulke119_4569671e-ed39-055f-8e78-422b96c9896b.json...
[2025-04-20T06:34:32.963+0000] {etl_to_dwh.py:54} INFO - Extract data Leo278_Franecki195_27eb7bda-3896-d2f9-47a7-4d739283e770.json...
[2025-04-20T06:34:32.985+0000] {etl_to_dwh.py:54} INFO - Extract data Lahoma872_Greenholt190_03bde354-de87-a404-4ab3-00edf0b184a7.json...
[2025-04-20T06:34:33.015+0000] {etl_to_dwh.py:54} INFO - Extract data Ada662_Sari509_Balistreri607_dbc4a3f7-9c69-4435-3ce3-4e1988ab6b91.json...
[2025-04-20T06:34:33.181+0000] {etl_to_dwh.py:54} INFO - Extract data Eva64_Gloria696_Gurule738_87cb7301-9d12-b048-416d-2b290eed1bde.json...
[2025-04-20T06:34:33.230+0000] {etl_to_dwh.py:54} INFO - Extract data Pauletta164_Spencer878_65016a46-14f4-d19a-f82f-10299aba4c14.json...
[2025-04-20T06:34:33.266+0000] {etl_to_dwh.py:54} INFO - Extract data Jeana169_Weimann465_2bd4d47d-5e00-3b67-cdd7-03f4b811b711.json...
[2025-04-20T06:34:33.304+0000] {etl_to_dwh.py:54} INFO - Extract data Hershel911_Labadie908_24a8f8bc-f502-5f0e-0dd7-27d64a15ed9e.json...
[2025-04-20T06:34:33.770+0000] {etl_to_dwh.py:54} INFO - Extract data Cathy455_Lanita675_Wolff180_14dc5e57-1b84-3305-c042-86c9fc7e4996.json...
[2025-04-20T06:34:33.803+0000] {etl_to_dwh.py:54} INFO - Extract data Joshua658_Kunde533_30a6452c-4297-a1ac-977a-6a23237c7b46.json...
[2025-04-20T06:34:33.828+0000] {etl_to_dwh.py:224} INFO - Successfully saved 108 patients to /opt/***/cleaned/patient.csv
[2025-04-20T06:34:33.834+0000] {etl_to_dwh.py:228} INFO - Successfully saved 108 encounters to /opt/***/cleaned/encounter.csv
[2025-04-20T06:34:33.837+0000] {etl_to_dwh.py:232} INFO - Successfully saved 108 conditions to /opt/***/cleaned/condition.csv
[2025-04-20T06:34:33.842+0000] {etl_to_dwh.py:236} INFO - Successfully saved 108 claims to /opt/***/cleaned/claim.csv
[2025-04-20T06:34:33.843+0000] {logging_mixin.py:188} INFO - Processing /opt/***/cleaned/patient.csv...
[2025-04-20T06:34:33.853+0000] {etl_to_dwh.py:262} INFO - Drop duplication in /opt/***/cleaned/patient.csv...
[2025-04-20T06:34:33.873+0000] {etl_to_dwh.py:275} INFO - Transformed file saved as: /opt/***/cleaned/patient.csv
[2025-04-20T06:34:33.873+0000] {logging_mixin.py:188} INFO - Processing /opt/***/cleaned/encounter.csv...
[2025-04-20T06:34:33.877+0000] {etl_to_dwh.py:262} INFO - Drop duplication in /opt/***/cleaned/encounter.csv...
[2025-04-20T06:34:33.884+0000] {etl_to_dwh.py:267} INFO - Change data format for column Start Encounter...
[2025-04-20T06:34:33.921+0000] {etl_to_dwh.py:267} INFO - Change data format for column End Encounter...
[2025-04-20T06:34:33.933+0000] {etl_to_dwh.py:275} INFO - Transformed file saved as: /opt/***/cleaned/encounter.csv
[2025-04-20T06:34:33.934+0000] {logging_mixin.py:188} INFO - Processing /opt/***/cleaned/condition.csv...
[2025-04-20T06:34:33.937+0000] {etl_to_dwh.py:262} INFO - Drop duplication in /opt/***/cleaned/condition.csv...
[2025-04-20T06:34:33.940+0000] {etl_to_dwh.py:267} INFO - Change data format for column On Set Date...
[2025-04-20T06:34:33.946+0000] {etl_to_dwh.py:267} INFO - Change data format for column Recorded Date...
[2025-04-20T06:34:33.954+0000] {etl_to_dwh.py:275} INFO - Transformed file saved as: /opt/***/cleaned/condition.csv
[2025-04-20T06:34:33.954+0000] {logging_mixin.py:188} INFO - Processing /opt/***/cleaned/claim.csv...
[2025-04-20T06:34:33.958+0000] {etl_to_dwh.py:262} INFO - Drop duplication in /opt/***/cleaned/claim.csv...
[2025-04-20T06:34:33.961+0000] {etl_to_dwh.py:267} INFO - Change data format for column billablePeriod Start...
[2025-04-20T06:34:33.967+0000] {etl_to_dwh.py:267} INFO - Change data format for column billablePeriod End...
[2025-04-20T06:34:33.971+0000] {etl_to_dwh.py:267} INFO - Change data format for column Created Date...
[2025-04-20T06:34:33.977+0000] {etl_to_dwh.py:275} INFO - Transformed file saved as: /opt/***/cleaned/claim.csv
[2025-04-20T06:34:33.978+0000] {etl_to_dwh.py:277} INFO - Transformation completed.
[2025-04-20T06:34:33.979+0000] {etl_to_dwh.py:310} INFO - Processing condition.csv...
[2025-04-20T06:34:33.979+0000] {etl_to_dwh.py:311} INFO - Load condition.csv to Staging schema...
[2025-04-20T06:34:34.058+0000] {taskinstance.py:2731} ERROR - Task failed with exception
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/sqlalchemy/engine/base.py", line 1910, in _execute_context
    self.dialect.do_execute(
  File "/home/airflow/.local/lib/python3.8/site-packages/sqlalchemy/engine/default.py", line 736, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.InvalidSchemaName: schema "staging" does not exist
LINE 2: CREATE TABLE staging.condition (
                     ^


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/taskinstance.py", line 444, in _execute_task
    result = _execute_callable(context=context, **execute_callable_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/taskinstance.py", line 414, in _execute_callable
    return execute_callable(context=context, **execute_callable_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/operators/python.py", line 200, in execute
    return_value = self.execute_callable()
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/operators/python.py", line 217, in execute_callable
    return self.python_callable(*self.op_args, **self.op_kwargs)
  File "/opt/airflow/script_etl/etl_to_dwh.py", line 385, in run_etl_to_dwh
    load_csv("/opt/airflow/transformed/")
  File "/opt/airflow/script_etl/etl_to_dwh.py", line 337, in load_csv
    df.to_sql(table_name, engine, schema=schema, if_exists='replace', index=False)
  File "/home/airflow/.local/lib/python3.8/site-packages/pandas/core/generic.py", line 2878, in to_sql
    return sql.to_sql(
  File "/home/airflow/.local/lib/python3.8/site-packages/pandas/io/sql.py", line 769, in to_sql
    return pandas_sql.to_sql(
  File "/home/airflow/.local/lib/python3.8/site-packages/pandas/io/sql.py", line 1910, in to_sql
    table = self.prep_table(
  File "/home/airflow/.local/lib/python3.8/site-packages/pandas/io/sql.py", line 1814, in prep_table
    table.create()
  File "/home/airflow/.local/lib/python3.8/site-packages/pandas/io/sql.py", line 914, in create
    self._execute_create()
  File "/home/airflow/.local/lib/python3.8/site-packages/pandas/io/sql.py", line 900, in _execute_create
    self.table.create(bind=self.pd_sql.con)
  File "/home/airflow/.local/lib/python3.8/site-packages/sqlalchemy/sql/schema.py", line 962, in create
    bind._run_ddl_visitor(ddl.SchemaGenerator, self, checkfirst=checkfirst)
  File "/home/airflow/.local/lib/python3.8/site-packages/sqlalchemy/engine/base.py", line 2221, in _run_ddl_visitor
    visitorcallable(self.dialect, self, **kwargs).traverse_single(element)
  File "/home/airflow/.local/lib/python3.8/site-packages/sqlalchemy/sql/visitors.py", line 524, in traverse_single
    return meth(obj, **kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/sqlalchemy/sql/ddl.py", line 899, in visit_table
    self.connection.execute(
  File "/home/airflow/.local/lib/python3.8/site-packages/sqlalchemy/engine/base.py", line 1385, in execute
    return meth(self, multiparams, params, _EMPTY_EXECUTION_OPTS)
  File "/home/airflow/.local/lib/python3.8/site-packages/sqlalchemy/sql/ddl.py", line 80, in _execute_on_connection
    return connection._execute_ddl(
  File "/home/airflow/.local/lib/python3.8/site-packages/sqlalchemy/engine/base.py", line 1477, in _execute_ddl
    ret = self._execute_context(
  File "/home/airflow/.local/lib/python3.8/site-packages/sqlalchemy/engine/base.py", line 1953, in _execute_context
    self._handle_dbapi_exception(
  File "/home/airflow/.local/lib/python3.8/site-packages/sqlalchemy/engine/base.py", line 2134, in _handle_dbapi_exception
    util.raise_(
  File "/home/airflow/.local/lib/python3.8/site-packages/sqlalchemy/util/compat.py", line 211, in raise_
    raise exception
  File "/home/airflow/.local/lib/python3.8/site-packages/sqlalchemy/engine/base.py", line 1910, in _execute_context
    self.dialect.do_execute(
  File "/home/airflow/.local/lib/python3.8/site-packages/sqlalchemy/engine/default.py", line 736, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.InvalidSchemaName) schema "staging" does not exist
LINE 2: CREATE TABLE staging.condition (
                     ^

[SQL: 
CREATE TABLE staging.condition (
	condition_id TEXT, 
	clinical_status TEXT, 
	verification_status TEXT, 
	category TEXT, 
	remark TEXT, 
	patient_id TEXT, 
	encounter_id TEXT, 
	"onsetDateTime" TIMESTAMP WITHOUT TIME ZONE, 
	"recordedDate" TIMESTAMP WITHOUT TIME ZONE
)

]
(Background on this error at: https://sqlalche.me/e/14/f405)
[2025-04-20T06:34:34.104+0000] {taskinstance.py:1149} INFO - Marking task as FAILED. dag_id=etl_stg_to_dwh_to_mart, task_id=task_etl_to_dwh, execution_date=20250420T063417, start_date=20250420T063420, end_date=20250420T063434
[2025-04-20T06:34:34.136+0000] {standard_task_runner.py:107} ERROR - Failed to execute job 5 for task task_etl_to_dwh ((psycopg2.errors.InvalidSchemaName) schema "staging" does not exist
LINE 2: CREATE TABLE staging.condition (
                     ^

[SQL: 
CREATE TABLE staging.condition (
	condition_id TEXT, 
	clinical_status TEXT, 
	verification_status TEXT, 
	category TEXT, 
	remark TEXT, 
	patient_id TEXT, 
	encounter_id TEXT, 
	"onsetDateTime" TIMESTAMP WITHOUT TIME ZONE, 
	"recordedDate" TIMESTAMP WITHOUT TIME ZONE
)

]
(Background on this error at: https://sqlalche.me/e/14/f405); 224)
[2025-04-20T06:34:34.173+0000] {local_task_job_runner.py:234} INFO - Task exited with return code 1
[2025-04-20T06:34:34.207+0000] {taskinstance.py:3312} INFO - 0 downstream tasks scheduled from follow-on schedule check
